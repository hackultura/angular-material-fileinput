!function(e){"use strict";var l=e.module("lfNgMdFileInput",["ngMaterial","ngMdIcons"]);l.directive("lfNgMdFileInput",["$q",function(l){return{restrict:"E",template:['<div class="lf-ng-md-file-input" >','<div class="lf-ng-md-file-input-preview-container" ng-class="{\'disabled\':bool_disabled}" ng-show="bool_file_null && bool_file_draggable">','<div class="lf-ng-md-file-input-drag" >','<div class="lf-ng-md-file-input-drag-text"> Drag & drop files here ... </div>',"</div>","</div>",'<div class="lf-ng-md-file-input-preview-container" ng-class="{\'disabled\':bool_disabled}" ng-hide="bool_file_null || !bool_file_preview">','<div class="close lf-ng-md-file-input-x" ng-click="removeFile()">&times;</div>','<div class="lf-ng-md-file-input-thumbnails">','<div class="lf-ng-md-file-input-frame" ng-repeat="lffile in lfFiles">','<div class="close lf-ng-md-file-input-x" ng-click="removeFileAt($index)">&times;</div>',"<img ng-src={{lffile.lfDataUrl}}>",'<div class="lf-ng-md-file-input-frame-footer">','<div class="lf-ng-md-file-input-frame-caption">{{lffile.lfFile.name}}</div>',"</div>","</div>",'<div class="clearfix" style="clear:both"></div>',"</div>","</div>",'<div class="lf-ng-md-file-input-container" >','<div tabindex="-1" class="lf-ng-md-file-input-caption" ng-class="{\'disabled\':bool_disabled}">','<!--<span class="file-caption-ellipsis">&hellip;</span>-->','<div class="lf-ng-md-file-input-caption-text" ng-hide="bool_file_null">','<ng-md-icon icon="insert_drive_file" size="20" style="fill:black; "></ng-md-icon>',"{{str_file_name}}","</div>",'<div class="lf-ng-md-file-input-caption-text-default" ng-show="bool_file_null">'," {{str_caption_placeholder}}","</div>","</div>",'<div class="" style="position:relative;display:table-cell;width:1%;white-space:nowrap;">','<md-button type="button" ng-disabled="bool_disabled" ng-hide="bool_file_null" ng-click="removeFile()" class="md-raised lf-ng-md-file-input-button lf-ng-md-file-input-button-remove">','<ng-md-icon icon="delete" size="24" style="fill:black;"></ng-md-icon>'," Remove","</md-button><!--",'--><md-button type="button" ng-disabled="bool_disabled" class="md-raised md-primary lf-ng-md-file-input-button lf-ng-md-file-input-button-brower">','<ng-md-icon icon="folder_open" size="24" style="fill:white;"></ng-md-icon>'," Browse",'<input type="file" accept="{{accept}}" ng-disabled="bool_disabled" class="lf-ng-md-file-input-type" onchange="angular.element(this).scope().onFileChanged(this)"/>',"</md-button>","</div>","</div>","</div>"].join(""),replace:!0,scope:{lfFiles:"=?",lfPlaceholder:"@?",accept:"@?",ngDisabled:"=?"},link:function(i,n,t){i.accept=i.accept||"image/*",i.lfFiles=[],i.bool_file_multiple=!1,i.bool_file_draggable=!1,i.bool_file_preview=!1,i.bool_file_null=!0,i.bool_disabled=!1,i.str_file_name="",i.str_caption_placeholder="Select file",e.isDefined(t.ngDisabled)&&i.$watch(function(){return i.ngDisabled},function(e){i.bool_disabled=e}),i.lfPlaceholder?i.str_caption_placeholder=i.lfPlaceholder:i.str_caption_placeholder="Select file","preview"in t&&(i.bool_file_preview=!0),"drag"in t&&(i.bool_file_draggable=!0),"multiple"in t?e.forEach(n.find("input"),function(l,n){"file"==e.element(l).attr("type")&&(i.bool_file_multiple=!0,e.element(l).attr("multiple","multiple"))}):e.forEach(n.find("input"),function(l,i){"file"==e.element(l).attr("type")&&e.element(l).removeAttr("multiple")}),e.forEach(n.find("div"),function(l,n){if("lf-ng-md-file-input-drag"==e.element(l).attr("class")){var t=e.element(l);t.bind("dragover",function(e){e.stopPropagation(),e.preventDefault(),i.bool_disabled||t.addClass("lf-ng-md-file-input-drag-hover")}),t.bind("dragleave",function(e){e.stopPropagation(),e.preventDefault(),i.bool_disabled||t.removeClass("lf-ng-md-file-input-drag-hover")}),t.bind("drop",function(l){if(l.stopPropagation(),l.preventDefault(),!i.bool_disabled){t.removeClass("lf-ng-md-file-input-drag-hover"),i.lfFiles=[];var n=l.target.files||l.dataTransfer.files,a=[],f=new RegExp(i.accept,"i");if(e.forEach(n,function(e,l){e.type.match(f)&&a.push(e)}),a.length>0&&(i.bool_file_null=!1),i.bool_file_multiple){1==a.length?i.str_file_name=""+a[0].name:i.str_file_name=""+a.length+" files selected";for(var d=0;d<a.length;d++)o(a[d],d).then(function(e){i.lfFiles.push({lfFile:a[e.index],lfDataUrl:e.result})},function(e){},function(e){})}else a.length>=1&&(i.str_file_name=""+a[0].name,o(a[0],0).then(function(e){i.lfFiles.push({lfFile:a[e.index],lfDataUrl:e.result})},function(e){},function(e){}))}})}}),i.removeFile=function(){i.bool_disabled||(i.lfFiles=[],i.str_file_name="",i.bool_file_null=!0)},i.removeFileAt=function(e){i.bool_disabled||(i.lfFiles.splice(e,1),0==i.lfFiles.length?(i.lfFiles=[],i.str_file_name="",i.bool_file_null=!0):1==i.lfFiles.length?i.str_file_name=""+i.lfFiles[0].lfFile.name:i.str_file_name=""+i.lfFiles.length+" files selected")},i.onFileChanged=function(e){var l=e.files;if(i.lfFiles=[],i.bool_file_null=!1,l.length>0){1==l.length?i.str_file_name=""+l[0].name:i.str_file_name=""+l.length+" files selected";for(var n=0;n<l.length;n++)o(l[n],n).then(function(e){i.lfFiles.push({lfFile:l[e.index],lfDataUrl:e.result})},function(e){},function(e){})}};var o=function(e,i){var n=l.defer(),t=new FileReader;return t.onloadstart=function(){n.notify(0)},t.onload=function(e){n.resolve({index:i,result:t.result})},t.onerror=function(e){n.reject(t.result)},t.onprogress=function(e){n.notify(e.loaded/e.total)},t.readAsDataURL(e),n.promise}}}}])}(window.angular);